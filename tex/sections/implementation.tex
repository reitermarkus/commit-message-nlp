\section{Implementation}
\label{sec:implementation}

The implementation itself is comprised of three parts:

\begin{itemize}
  \item scraping
  \item tagging
  \item training/testing
\end{itemize}

\subsection{Scraping}

The scraping process is a curious case since it was problematic to some extend.
More in that regard can be found in \autoref{sec:challenges}. The basic idea
of the scraping process was to fetch repositories and their commits from
GitHub. This was done with the help of PyGithub. The code itself for the
process of repository gathering is rather simple. A basic array with all
languages was defined as seen in \autoref{lst:languages}, which is then used to
iterate over and actually search for repositories for the corresponding language
with the specific GitHub query syntax as seen in \autoref{lst:query}.

\begin{lstlisting}[language=python, label={lst:languages}, caption={Array of all languages for scraping}]
languages = [
  'python',
  'javascript',
  'go',
  'typescript',
  'rust',
  'kotlin',
  'java',
  'c++',
  'c#',
  'swift',
]
\end{lstlisting}

\begin{lstlisting}[language=python, label={lst:query}, caption={GitHub query syntax}]
g.search_repositories(query=f'language:{language}', sort='stars', order='desc'):
\end{lstlisting}

This then yields all repositories sorted by \textit{stars} in descending order.
Stars is a metric on GitHub to show a repository's significance. Each star represents
a user on GitHub who has starred this repository. In the code
\lstinline{itertools.islice(commit_iter, 10000)} limits a repository to 10000
commits. A global counter keeps track of all the commits processed and if the
100000th commit is reached, repositories for the next language will be fetched.
This means that at least ten repositories per language are considered. Because
the process of scraping is time and space intensive the results are cached. Per
language one CSV file is created. The file consists of rows with four columns:

\begin{itemize}
  \item repository
  \item language
  \item author
  \item message
\end{itemize}

With this structure all important information is included in the file which is
essential for further processing. An example of one file can be seen in
\autoref{lst:csv}.

\begin{lstlisting}[language=xml, label={lst:csv}, caption={Excerpt of \textit{typescript.csv} with commits from the repository \textit{microsoft/vscode}}]
repository,language,author,message
microsoft/vscode,typescript,roblourens@gmail.com,"Fix #126087"
microsoft/vscode,typescript,penn.lv@gmail.com,":notebook: differenciate editor focus and list view focus"
microsoft/vscode,typescript,me@tylerleonhardt.com,"always hide quickinput on iPad when focus is lost fixes #125284"
microsoft/vscode,typescript,connor@peet.io,"fix: use inline sourcemaps in watch task"
microsoft/vscode,typescript,alexdima@microsoft.com,"update `monaco.d.ts`"
\end{lstlisting}

\subsection{Tagging}

The next step is to tag commits. We distinguish between two categories of tagged
commits:

\begin{itemize}
  \item Conventional commits
  \item Gitmoji commits
\end{itemize}

A specific regular expression for each category has to be matched in order to
tag the commit. The lookup in case of a match is done by searching for the
specific tag in a dictionary. Each category also has a specific dictionary. In
case of a conventional commit \autoref{lst:tag_map} will be searched,
Gitmoji commits \autoref{lst:gitmoji_map} otherwise.

\begin{lstlisting}[language=python, label={lst:gitmoji_map}, caption={Dictionary for Gitmoji mappings}]
gitmoji_mappings = {
  ':memo:':             'docs',        # Documentation
  ':zap:':              'perf',        # Performance
  ':fire:':             'remove',      # Removal
  ':sparkles:':         'feat',        # Feature
  ':bug:':              'fix',         # Bug Fix
  ':recycle:':          'refactor',    # Refactor Code
  ...
}
\end{lstlisting}

\begin{lstlisting}[language=python, label={lst:tag_map}, caption={Dictionary for conventional tag mappings}]
tag_mappings = {
  'bug':           'fix',
  'testing':       'test',
  'documentation': 'docs',
  'feature':       'feat',
  'gui':           'ui',
  ...
}
\end{lstlisting}
